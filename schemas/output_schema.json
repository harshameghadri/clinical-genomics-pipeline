{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Clinical Genomics Pipeline Output Schema",
  "description": "Schema for Phase 1 pipeline outputs",
  "type": "object",
  "properties": {
    "pipeline_info": {
      "type": "object",
      "properties": {
        "name": {"type": "string", "const": "clinical-genomics-pipeline"},
        "version": {"type": "string", "pattern": "^\\d+\\.\\d+\\.\\d+$"},
        "run_id": {"type": "string"},
        "start_time": {"type": "string", "format": "date-time"},
        "end_time": {"type": "string", "format": "date-time"},
        "success": {"type": "boolean"}
      },
      "required": ["name", "version", "run_id", "start_time", "success"]
    },
    "samples": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "sample_id": {"type": "string"},
          "original_id": {"type": "string"},
          "sample_type": {"type": "string", "enum": ["DNA", "RNA"]},
          "anonymized": {"type": "boolean"},
          "processing_status": {"type": "string", "enum": ["completed", "failed", "processing"]},
          "files": {
            "type": "object",
            "properties": {
              "fastq": {
                "type": "array",
                "items": {"type": "string"}
              },
              "bam": {"type": "string"},
              "vcf": {"type": "string"},
              "gvcf": {"type": "string"},
              "structural_variants": {"type": "string"},
              "copy_number_variants": {"type": "string"},
              "quantification": {"type": "string"},
              "qc_reports": {
                "type": "array",
                "items": {"type": "string"}
              }
            }
          },
          "metrics": {
            "type": "object",
            "properties": {
              "fastqc": {
                "type": "object",
                "properties": {
                  "total_sequences": {"type": "integer"},
                  "sequence_length": {"type": "string"},
                  "gc_content": {"type": "number"},
                  "quality_scores": {"type": "string"}
                }
              },
              "alignment": {
                "type": "object",
                "properties": {
                  "total_reads": {"type": "integer"},
                  "mapped_reads": {"type": "integer"},
                  "mapping_rate": {"type": "number"},
                  "properly_paired": {"type": "number"}
                }
              },
              "variants": {
                "type": "object",
                "properties": {
                  "total_variants": {"type": "integer"},
                  "snps": {"type": "integer"},
                  "indels": {"type": "integer"},
                  "structural_variants": {"type": "integer"},
                  "copy_number_variants": {"type": "integer"}
                }
              },
              "expression": {
                "type": "object",
                "properties": {
                  "quantified_transcripts": {"type": "integer"},
                  "expressed_transcripts": {"type": "integer"},
                  "mapping_rate": {"type": "number"}
                }
              }
            }
          },
          "checksums": {
            "type": "object",
            "patternProperties": {
              ".*": {"type": "string"}
            }
          }
        },
        "required": ["sample_id", "sample_type", "processing_status"]
      }
    },
    "quality_control": {
      "type": "object",
      "properties": {
        "multiqc_report": {"type": "string"},
        "overall_status": {"type": "string", "enum": ["pass", "warning", "fail"]},
        "failed_samples": {
          "type": "array",
          "items": {"type": "string"}
        }
      }
    },
    "metadata": {
      "type": "object",
      "properties": {
        "database_file": {"type": "string"},
        "total_files": {"type": "integer"},
        "total_size_gb": {"type": "number"},
        "gdpr_compliant": {"type": "boolean"}
      }
    },
    "tool_versions": {
      "type": "object",
      "patternProperties": {
        ".*": {"type": "string"}
      }
    }
  },
  "required": ["pipeline_info", "samples", "quality_control", "metadata"]
}